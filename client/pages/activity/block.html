<Template name='block'>
  <div class="block block-{{type}} panel panel-default row">
    <div class="panel-heading">
      {{>xedit collection='Blocks' field='title' _id=_id type='text' enabledEmptyText='Click here to add a title.' mode='inline' enabledState=enabledState}}
      {{#if inEditedWall}} 
        <div class="pull-right">
          <a class="glyphicon glyphicon-copy" title="Copy Block to clipboard"></a>
          {{>showHide collection='Blocks' itemName='block' item=this}}
          {{#unless fileCount}}
            <a class="glyphicon glyphicon-remove deleteBlock" title="Delete Block"></a>
          {{/unless}}
        </div>
      {{/if}}
    </div>
    <div class="panel-body">
      {{> blockType}}
    </div>
    <div class="panel-footer">
      {{#if inEditedWall}}
        <span class="avoidwrap">created 9:30pm 3/29/15  by Matt Greenwolfe, </span>
        <span class="avoidwrap">last modified 10:05am 3/30/15 by Matt Greenwolfe</span>
      {{/if}}
    </div>
  </div>
</Template>

<Template name="textBlock">
    {{>xedit collection='Blocks' field='text' _id=_id type='wysihtml5' enabledEmptyText='Click here to edit.' enabledState=enabledState}}
</Template>

<Template name="embedBlock">
  {{#unless inEditedWall}} {{#if embedCodeWithNoScript}}
    <div class="embed-responsive embed-responsive-4by3">
      {{{embedCodeWithNoScript}}}
    </div>
  {{/if}} {{else}}
    <p>
      Click below to edit or replace the embed code.
      {{>xedit collection='Blocks' field='embedCode' _id=_id type='textarea' mode="inline" enabledEmptyText='Click here to paste embed code from another web site.' enabledState=enabledState}}
    </p>
  {{/unless}}
  <p>
    {{>xedit collection='Blocks' field='text' _id=_id type='wysihtml5' enabledEmptyText='Click here to add a description.' enabledState=enabledState}}
  </p>
</Template>

<Template name="imageBlock">
  {{#if imageFile}} 
    <p>
      <a href="/upload/{{imageFile.path}}"><img src="/upload/{{imageFile.path}}"></a>
    </p> 
  {{/if}}
  {{#if inEditedWall}}
    {{#if imageFile}} 
      {{#with imageFile}}
        {{> deleteImageButton}}
      {{/with}}
    {{else}}
      <p>
        Upload an image file.
        {{>upload_bootstrap fileTypes='image/*' callbacks=processUpload}}
      </p> 
    {{/if}}
  {{/if}}
  <p>
    {{>xedit collection='Blocks' field='text' _id=_id type='wysihtml5' enabledEmptyText='Click here to add a description.' enabledState=enabledState}}
  </p>
</Template>

<Template name="deleteImageButton">
  <button class="btn btn-warning deleteImageFile">Delete Image</button>
</Template>

<Template name="fileBlock">
  <p>
    {{>xedit collection='Blocks' field='text' _id=_id type='wysihtml5' enabledEmptyText='Click here to add a description.' enabledState=enabledState}}
  </p>
  {{#sortable1c items=files  options=sortableOpts}} 
    {{>fileLink}}
  {{/sortable1c}}
  {{#if inEditedWall}}
    <p>
      {{>upload_bootstrap callbacks=processUpload}}
    </p> 
  {{/if}}
</Template>

<Template name="fileLink">
  <p class="file">
    {{#if inEditedWall 2}}
      <a class="glyphicon glyphicon-move moveFile"></a>
      {{>showHide collection='Files' itemName='file' item=this}}
      <a class="glyphicon glyphicon-remove deleteFile" title="delete file"></a>
    {{/if}}
    <a href="/upload/{{path}}">{{name}}</a>
  </p> 
</Template>